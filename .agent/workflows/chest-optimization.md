---
description: 寶箱搜尋優化與歷史記錄機制
---

# 寶箱搜尋優化功能

## 功能概述

基於歷史記錄的智能方向跳過系統，自動學習哪些方向沒有寶箱。

## 核心特性

- **自動學習**: 前3次收集數據，第4次開始跳過無寶箱方向
- **智能判斷**: 從未找到→跳過，曾經找到/嘗試不足→繼續搜尋
- **自動保存**: 歷史記錄保存到 `chest_direction_history.json`

## 效果預期

### 數據收集階段（第1-3次）
每次搜尋所有方向（左上、右上、左下、右下）

### 優化階段（第4次及以後）
跳過 3 次都沒找到的方向，**節省時間 50%**

## 數據文件格式

```json
{
  "水路一號街": {
    "左上": {"attempts": 5, "found": 0, "last_search": "2025-10-27T12:34:56"},
    "右上": {"attempts": 5, "found": 4, "last_search": "2025-10-27T12:35:12"}
  }
}
```

## 跳過邏輯

```python
if attempts >= 3 and found == 0:
    return False  # 跳過
else:
    return True   # 繼續搜索
```

## 故障排除

- **優化沒生效**: 確認運行至少3次
- **跳過有寶箱方向**: 刪除 `chest_direction_history.json` 重新收集
