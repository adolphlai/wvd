# 水路一号街当前查找方向顺序说明

## 📋 当前配置

```json
"Dist": {
    "_TYPE": "dungeon",
    "questName": "[宝箱]水路一号街",
    "_TARGETINFOLIST": [
        ["chest","左上",null],
        ["chest","右上",null],
        ["chest","左下",null],
        ["chest","右下",null],
        ["harken"]
    ]
}
```

---

## 🔄 查找顺序

### **目标执行顺序（按配置顺序）：**

1. **第1个目标：`["chest","左上",null]`**
   - 搜索方向：**左上**（只有1个方向）
   - swipeDir = `[[100,250,700,1200]]`

2. **第2个目标：`["chest","右上",null]`**
   - 搜索方向：**右上**（只有1个方向）
   - swipeDir = `[[700,250,100,1200]]`

3. **第3个目标：`["chest","左下",null]`**
   - 搜索方向：**左下**（只有1个方向）
   - swipeDir = `[[100,1200,700,250]]`

4. **第4个目标：`["chest","右下",null]`**
   - 搜索方向：**右下**（只有1个方向）
   - swipeDir = `[[700,1200,100,250]]`

5. **第5个目标：`["harken"]`**
   - 搜索方向：默认5个方向（中央、左上、右上、右下、左下）
   - 但会跳过中央（代码特殊处理）

---

## 📊 完整执行流程

### **循环1（第1次进入地下城）：**

```
1. 处理目标1：["chest","左上"]
   ├─> 打开地图
   ├─> 滑动到左上方向
   ├─> 搜索宝箱
   ├─> 找到？→ 点击 → AutoMove → 移动到宝箱 → 开箱
   └─> 没找到？→ 从列表移除该目标 → 继续下一个目标

2. 处理目标2：["chest","右上"]
   ├─> 打开地图（如果之前关闭了）
   ├─> 滑动到右上方向
   ├─> 搜索宝箱
   └─> ...

3. 处理目标3：["chest","左下"]
   └─> ...

4. 处理目标4：["chest","右下"]
   └─> ...

5. 处理目标5：["harken"]
   ├─> 搜索传送点
   └─> 找到后退出地下城
```

### **循环2（重新进入地下城）：**

```
1. 再次处理目标1：["chest","左上"]
   ├─> 检查历史记录
   ├─> 如果 attempts >= 3 且 found == 0 → 跳过
   └─> 否则继续搜索

2. 再次处理目标2：["chest","右上"]
   └─> ...

（以此类推）
```

---

## ⚠️ 重要特点

### **1. 每个目标独立处理**

- 每个 `["chest","左上"]` 等是独立的目标项
- 会按顺序逐个处理
- 如果某个目标找不到宝箱，会从列表中移除
- 但**如果找到宝箱并开箱，该目标不会移除**，下次循环还会继续搜索

### **2. 每个目标只有一个方向**

- `["chest","左上"]` → 只搜索"左上"方向
- `["chest","右上"]` → 只搜索"右上"方向
- 不会像 `["chest"]` 那样搜索5个方向

### **3. 历史记录的影响**

- 每个方向有独立的历史记录
- 如果"左上"方向3次都没找到，后续遇到 `["chest","左上"]` 时会跳过
- 但不影响其他方向的目标项

---

## 🎯 实际执行顺序示例

### **第一次运行（无历史记录）：**

```
进入地下城
  ↓
打开地图
  ↓
处理目标1：["chest","左上"]
  ├─> 滑动到左上（2秒）
  ├─> 搜索宝箱
  ├─> 找到 → 移动 → 开箱
  └─> 目标1不移除，保留在列表中
  ↓
处理目标2：["chest","右上"]
  ├─> 打开地图（如果关闭了）
  ├─> 滑动到右上（2秒）
  ├─> 搜索宝箱
  └─> ...
  ↓
处理目标3：["chest","左下"]
  └─> ...
  ↓
处理目标4：["chest","右下"]
  └─> ...
  ↓
处理目标5：["harken"]
  └─> 退出地下城
  ↓
重新进入地下城（循环）
```

### **第二次运行（有历史记录）：**

```
进入地下城
  ↓
处理目标1：["chest","左上"]
  ├─> 检查历史："左上" attempts=1, found=1
  ├─> found > 0 → 继续搜索（曾经找到过）
  └─> 搜索并更新历史
  ↓
处理目标2：["chest","右上"]
  ├─> 检查历史："右上" attempts=1, found=0
  ├─> attempts < 3 → 继续搜索
  └─> 搜索并更新历史
  ↓
...（继续处理其他目标）
```

---

## 📝 总结

**当前水路一号街的查找方向顺序：**

1. **左上** → 2. **右上** → 3. **左下** → 4. **右下** → 5. **harken（传送点）**

**特点：**
- 顺序是按照配置文件中 `_TARGETINFOLIST` 的顺序
- 每个方向是独立的目标项
- 按顺序逐个处理
- 历史记录会记录每个方向的搜索结果

