# 整理背包功能開發記錄

## 功能概述

返回城鎮後自動將指定物品放入倉庫的功能。

---

## 修改詳情

### 1. script.py 修改

#### 新增配置變數

```python
["organize_backpack_enabled_var", tk.BooleanVar, "_ORGANIZE_BACKPACK_ENABLED", False],
["organize_backpack_count_var",   tk.IntVar,     "_ORGANIZE_BACKPACK_COUNT",   0],
```

#### 新增 `get_organize_items()` 函數

讀取 `resources/images/Organize/` 資料夾中的物品圖片。

#### 新增 `StateOrganizeBackpack(num_characters)` 函數

**流程：**
1. 點選角色座標 → Sleep(5)
2. 點選 inventory → Sleep(5)
3. 遍歷物品：點擊 → Sleep(5) → 點 putinstorage → Sleep(5)
4. 關閉 inventory → Sleep(5)
5. 返回角色選擇 → Sleep(5)

#### 修改 `StateInn()` 函數

在補給後、住宿前調用整理背包。

#### 新增 `TestFactory()` 函數

獨立的測試工廠，包含：
- 獨立的 ADB 連接
- 停止信號檢查
- 完整的整理背包邏輯

---

### 2. gui.py 修改

#### 新增測試分頁

**功能：**
- 完全獨立運行，不需啟動主任務
- ADB 狀態顯示
- 按鈕自動連接 ADB

#### 新增 `_test_organize_backpack_standalone()` 方法

**特點：**
- 自動連接 ADB
- 點擊時禁用按鈕防止重複
- 完成後自動重新啟用

---

## 角色座標

| 角色 | X | Y |
|------|-----|------|
| 0 | 162 | 1333 |
| 1 | 465 | 1333 |
| 2 | 750 | 1333 |
| 3 | 162 | 1515 |
| 4 | 465 | 1515 |
| 5 | 750 | 1515 |

---

## 使用方法

### 正式使用
1. 將物品圖片放入 `resources/images/Organize/`
2. 在「進階設定」啟用整理背包
3. 設定角色數量
4. 正常啟動腳本

### 獨立測試
1. 確保遊戲在 Inn 角色選擇畫面
2. **不要啟動主任務**
3. 切換到「測試」分頁
4. 點擊「測試整理背包」

---

## 需要的圖片

| 圖片 | 路徑 |
|------|------|
| inventory.png | resources/images/ |
| putinstorage.png | resources/images/ |
| closeInventory.png | resources/images/ |
| *.png | resources/images/Organize/ |
