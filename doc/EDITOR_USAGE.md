# Quest Editor 使用說明

本編輯器提供圖形化介面，讓您能直觀地修改腳本流程、新增任務目標或調整點擊位置。

## 啟動流程

編輯器分為「主程式服務」與「編輯介面」兩部分，請依照以下順序啟動：

### 第一步：啟動通訊服務
編輯器需要透過主程式來控制模擬器與讀取檔案。

1. 開啟 **WvDAS 主程式**。
2. 進入上方 **「測試」** 分頁。
3. 找到下方的 **「Quest 編輯器」** 區塊。
4. 點擊 **「啟動伺服器」** 按鈕。
   * 確認狀態轉變為 `✓ 運行中 ws://localhost:8765`。
<img width="591" height="130" alt="image" src="https://github.com/user-attachments/assets/56ec3a73-ce7a-4836-b923-dc2159cf54db" />


### 第二步：開啟編輯器
1. 進入 `editor-lite` 資料夾。
2. 執行 **DungeonEditor.exe**。
3. 程式會開啟一個控制台視窗（顯示 Port 3000），並自動打開瀏覽器進入編輯介面。
   * 若瀏覽器未自動彈出，可點擊視窗上的 **「開啟編輯器網頁」** 按鈕。
<img width="527" height="348" alt="image" src="https://github.com/user-attachments/assets/ff73b987-183e-4d5d-8bdf-79e1e57a1766" />

4. 若介面顯示 **"No Signal"** 且上方按鈕為 **紅色** <img src="../resources/assets/disconnected.png" height="20"/> (或類似圖示)，請點擊該紅色按鈕以連線。
<img width="359" height="68" alt="image" src="https://github.com/user-attachments/assets/71cea558-6920-4e90-b3f3-acf836c32509" />

6. 確認上方按鈕轉為 **綠色**，且介面顯示 **🟢 已連線** (Connected)。
7. 點擊右上角的 **「讀取」** 按鈕，載入 `quest.json` 任務檔。

---

## 編輯操作指南

### 1. 任務管理
*   **選擇任務**: 點擊右側上方的下拉選單，選擇您要編輯的任務名稱（例如 `[打王]深雪教會區`）。
*   **建立任務**: 點擊 **「建立任務」** 或 **「+」** 按鈕，輸入唯一的任務 ID (例如 `MyNewQuest`) 與顯示名稱。
*   **刪除/複製**: 使用下拉選單旁的圖示按鈕進行操作。

### 2. 編輯任務步驟
任務通常分為兩個部分，請依據需求編輯：

#### A. 進入步驟 (Entry / _EOT)
定義「從村莊進入地城」的過程。
*   **目標 (Target)**: 選擇要點擊的按鈕圖片（例如 `DH` 代表進入地城按鈕）。
*   **指令 (Command)**: 通常皆為 `press` (點擊)。
*   **後備動作 (Fallback)**: 如果找不到該圖片，要執行的替代動作（例如點擊某個座標或滑動）。

#### B. 移動目標 (Moves / _TARGETINFOLIST)
定義「在地城中移動」的路徑。
*   **新增節點**: 點擊列表下方的 **「+」** 新增移動點。
*   **Position (座標移動)**:
    1.  在地城大地圖畫面中，將地圖滑動到目標區域。
    2.  在編輯器中新增 `position` 節點。
    3.  **設定座標**: 直接點擊左側 **模擬器畫面** 上的目標位置，座標會自動填入。
    4.  **滑動方向**: 選擇剛才滑動的方向（例如 `右下`），這告訴腳本開地圖後要往哪滑。
*   **Stair (樓梯)** / **Harken (哈肯)**: 類似座標移動，但在抵達後會進行換層判定。

### 3. 工具與測試
*   **畫面截圖**: 若需要新的辨識圖片（例如新的地城入口按鈕），可點擊介面上的 **「截圖 (Capture)」** 按鈕存檔。
*   **點擊測試**: 在左側畫面上直接點擊，模擬器會同步執行點擊。可用來測試座標是否準確點擊到遊戲按鈕。
*   **存檔生效**: 編輯完成後，務必點擊右上角 **「儲存 (Save)」**。回到主程式重啟腳本即可看到新任務。
